<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <!-- 保证地图的清晰显示和最佳性能，请通过viewport设置页面显示比例为1，并禁止用户缩放页面 -->
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <title>我的奖品</title>
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/demo.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/flexible.js"></script>
    <script type="text/javascript" src="src/lib/jquery/jquery.md5.js"></script>
    <script type="text/javascript" src="src/lib/common/common.js"></script>
    <script type="text/javascript" src="src/lib/common/farming.js"></script>
    <script type="text/javascript" src="src/lib/common/public.js"></script>
    <script type="text/javascript" src="src/lib/public/public.js"></script>
    <!-- layer -->
    <script type="text/javascript" src="src/lib/layer/layer.js"></script>
    <!-- dropload -->
    <link rel="stylesheet" href="src/lib/zepto/dropload.css">
    <script type="text/javascript" src="src/lib/zepto/dropload.min.js"></script>
    <style type="text/css">
    .none-more-content {
        color: #868686;
        font-size: 14px;
        height: 200px;
        line-height: 200px;
        text-align: center;
    }

    .award-wrap {
        width: 92%;
        margin: 0.4rem auto;
        border-radius: 0.08rem;
    }

    .award-item {
        float: left;
        padding: 0.2rem;
        width: 96%;
        border-radius: 6px;
        background: url(images/img4.png) no-repeat;
        margin-bottom: 0.4rem;
    }

    .award-item.disabled {
        background: #c3c3c3;
    }

    .flex {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .award-item .award-item-box {
        margin-bottom: 0.5rem;
    }

    .award-item .award-item-box:last-child {
        margin-bottom: 0rem;
    }

    .award-item .award-item-box p {
        color: #fff;
    }

    .award-item .award-item-box .award-name {
        font-size: 18px;
    }

    .award-item .award-item-box .btn-exchange {
        color: #fe4c58;
        background: #fff;
        border-radius: 20px;
        padding: 0.2rem 0.3rem;
        font-weight: 600;
    }

    .award-item.disabled .award-item-box .btn-exchange {
        color: #c3c3c3;
    }

    .clearfix:after {
        content: ".";
        display: block;
        height: 0;
        clear: both;
        visibility: hidden;
    }

    .clearfix:after,
    .clearfix:before {
        zoom: 1;
    }

    .mask {
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        z-index: 999;
        background: #000;
        opacity: 0.4;
        display: none;
    }

    .award-dialog .content {
        position: relative;
        height: 100%;
        width: 100%;
    }

    .award-dialog {
        display: none;
        position: absolute;
        width: 240px;
        height: 330px;
        left: 50%;
        top: 50%;
        margin-left: -120px;
        margin-top: -165px;
        background: url(images/img3.png) no-repeat;
        background-size: 100% 100%;
        border-radius: 13px;
        z-index: 1000;
    }

    .award-con {
        text-align: center;
        margin-top: 1rem;
        color: #fc2c50;
        font-size: 18px;
    }

    .address-list {
        position: absolute;
        text-align: left;
        margin-left: 0.5rem;
        margin-bottom: 0.2rem;
        bottom: 1.7rem;
        color: #fff;
        width: 88%;
    }

    .eval-all-ula li.choise  {
        overflow: initial;
    }

    .choise {
        position: relative;overflow: initial;
    }

    .pplist {
        border: 1px solid #dcdcdc;
        display: none;
        position: absolute;
        top: 0.973rem;
        left: 0;
        width: 100%;
        z-index: 99;
    }

    .ppitem {
        height: 1.173rem;
        line-height: 1.173rem;
        padding-right: 0.84rem;
        background: #fff;
        border-bottom: 1px solid #fff;
        background: #dcdcdc;
        color: #fff;
    }

    .ppitem:last-child {
        border-bottom: none;
    }


    body {
        position: relative;
    }
    </style>
    <script type="text/javascript">
    $(function() {
        $('.btn-exchange').click(function() {
            $('.mask').show();
            $('.award-dialog').show();
        })
        $('.mask').click(function() {
            $(this).hide();
            $('.award-dialog').hide();
        });
    });
    </script>
</head>

<body>
    <div class="mask"></div>
    <div class="award-dialog">
        <div class="content">
            <div class="award-content">
                <p class="award-con">鸡蛋10个</p>
            </div>
            <ul class="address-list clearfix">
                <li>1.上海市闵行区</li>
                <li>2.上海市闵行区</li>
            </ul>
        </div>
    </div>
    <section class="body-bj  ">
        <section class="header-fixed-cont ">
            <section class="header-fixed ">
                <section class="header ovw posin">我的奖品</section>
                <ul class="eval-all-ula ms-work-ula pick-work-ula">
                    <li class="choise"><span id="education">类型</span>
                        <div class="pplist">
                        </div></li>
                    <li class="choise"><span id="education">状态</span>
                        <div class="pplist">
                        <div class="ppitem" data-type="0">所有</div>
                        <div class="ppitem" data-type="1">已兑换</div>
                        <div class="ppitem" data-type="2">未兑换</div>
                        </div></li>
                </ul>
            </section>
        </section>
        <section class="layer-bj layer-map-bj" style="display: none;"></section>
        <ul class="layer-sorting layer-up-some ovw mac-list-time-auto layer-time1" style="display: none;">
            <li class="hover" mac-list-auto="1">土鸡蛋</li>
            <li class="" mac-list-auto="2">红包</li>
            <li class="" mac-list-auto="3">雨伞</li>
        </ul>
        <ul class="layer-sorting layer-up-some ovw mac-list-sort-auto" style="display: none;">
            <li class="hover" mac-list-auto="1">立刻兑换</li>
            <li class="" mac-list-auto="2">已兑换</li>
            <li class="" mac-list-auto="3">未兑换 </li>
        </ul>
        <section class="ms-contents qzlb" style="background: #ececec none repeat scroll 0 0;"></section>
        <ul class="award-wrap clearfix">
            <li class="award-item">
                <div class="award-item-box flex">
                    <p class="fl award-name">土鸡蛋</p>
                    <p class="fr btn-exchange">立即兑换</p>
                </div>
                <div class="award-item-box flex">
                    <p class="fl">10个</p>
                    <p class="fr">2016-08-12</p>
                </div>
            </li>
            <li class="award-item disabled">
                <div class="award-item-box flex">
                    <p class="fl award-name">红包</p>
                    <p class="fr btn-exchange">立即兑换</p>
                </div>
                <div class="award-item-box flex">
                    <p class="fl">10个</p>
                    <p class="fr">2016-08-12</p>
                </div>
            </li>
        </ul>
    </section>
    <script type="text/javascript">
        /*function GetQueryString(name)
        {
             var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
             var r = window.location.search.substr(1).match(reg);
             if(r!=null)return  unescape(r[2]); return null;
        };
        var userid = GetQueryString('userid')
        var pulishID = GetQueryString('pulishID')*/
       var userid = 1;
        var apiURL = 'http://ngy.innke.net/apiv2/index.php';
        var id = '0';
        var status = '0';
        var page = '1';
        $.ajax({
            url: apiURL, //接口地址
            data: { 'cmd': 'prizeTypeList', 'userid': userid, 'ts': parseInt(new Date().getTime() / 1000), 'params': {}, 'jsonp': 1 },
            dataType: 'jsonp',
            success: function(data) {
                console.info(data);
                var data = data.body.list;
                var str = '';
                for (var i = 0; i < data.length; i++) {
                    str += '<div class="ppitem" data-id="' + data[i].ID + '">' + data[i].name + '</div>'
                }
                $('.pplist').eq(0).html(str)
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                layer.msg('网络请求延迟！');
                console.info(XMLHttpRequest.status);
                console.info(XMLHttpRequest.readyState);
                console.info(textStatus);
            },
        });
        $('.choise').click(function() {
            $(this).find('.pplist').slideToggle();
        })
        $('.choise').on('click', '.ppitem', function(e) {
            e.stopPropagation();
            var val = $(this).text();
            $(this).parents('.choise').find('span').text(val)
            $(this).parents('.choise').find('.pplist').slideToggle();
            var type  =$(this).attr('ID')
            if(type){
                id  = ID;
            }else {
                status = $(this).attr('data-type')
            }
            renderList(id,status,page)
        })
        function renderList(ids,statuss,pages){
            var params = {
                ID:ids,
                status:statuss,
                page:pages,
                num:10,
            }
            params = objKeySort(params);//按照属性名升序排列
            var params_str = objChangeStr(params);//拼接params参数的属性值
            params.verify = $.md5('myPrizeList'+ parseInt(new Date().getTime() / 1000)+params_str+'security');//生成验证码
          $.ajax({
              url: apiURL, //接口地址
              data: { 'cmd': 'myPrizeList', 'userid': userid, 'ts': parseInt(new Date().getTime() / 1000), 'params': params, 'jsonp': 1 },
              dataType: 'jsonp',
              success: function(data) {
                  console.info(data);
                  var data = data.body.list;
                  var str = '';
                  for (var i = 0; i < data.length; i++) {
                      str += '<li class="award-item">'
                            +   '<div class="award-item-box flex">'
                            +       '<p class="fl award-name">土鸡蛋</p>'
                            +       '<p class="fr btn-exchange">立即兑换</p>'
                            +    '</div>'
                            +    '<div class="award-item-box flex">'
                            +        '<p class="fl">10个</p>'
                            +        '<p class="fr">2016-08-12</p>'
                            +    '</div>'
                            +'</li>'
                  }
                  $('.award-wrap').html(str)
              },
              error: function(XMLHttpRequest, textStatus, errorThrown) {
                  layer.msg('网络请求延迟！');
                  console.info(XMLHttpRequest.status);
                  console.info(XMLHttpRequest.readyState);
                  console.info(textStatus);
              },
          });
        }
        renderList('0','0','1')
    </script>
</body>

</html>